/*******************************************************************\

Module:

Author: Dario Cattaruzza

Date: November 2017

\*******************************************************************/

#include <fstream>
#include <iostream>
#include <sstream>
#include <vector>
#include <cstring>

/// Loads a binary file into a c array and creates c and h files to
/// access  it from code.
int main(int argc, char *argv[])
{
  size_t size;
  const char *varname = nullptr;

  if(argc!=2 || strlen(argv[1])==0)
  {
    std::cout << "Usage: converter VARNAME\n";
    std::cout << "\n";
    return 1;
  }
  varname=argv[1];

  printf("// File automatically generated by " __FILE__ "\n\n");

  size=0;
  printf("#define %s_DATA \\\n  ", varname);
  if(!std::cin.eof())
  {
    size++;
    printf("0x%02x", (unsigned char) std::cin.get());

    while(!std::cin.eof())
    {
      printf(", ");
      if(size % 16 == 0)
        printf("\\\n  ");
      printf("0x%02x", (unsigned char) std::cin.get());
      size++;
    }
    printf("\n");
  }

  printf("\n#define %s_SIZE %zu\n\n", varname, size);

  return 0;
}
